#!/bin/bash
version="0.0.1"

errorBanner="$(cat <<-EOF
error during command or command not found.
type ./shell help for help."
EOF
)"

helpMessage="$(cat <<-EOF
HELP
----

help:
./shell help

EOF
)"

help () {
    echo "${helpMessage}"
    exit
}

#
# BODY
#
main () {
[ -z ${command} ] && command="help"
    store=${SHKV_STORE}
    if [ "${command}" != "help" ] && [ "${store}" = "" ]; then
        echo "aborted. target store absolute path should be pointed with SHKV_STORE environment variable"
        exit
    fi

    cwd=$(pwd)
    echo "version: ${version}, command: ${command}"
    declare -F ${command} &> /dev/null && ${command} ${@:2} || echo "${errorBanner}"
}

command="$1"
store=${SHKV_STORE}
cwd=$(pwd)

main ${@:2}
